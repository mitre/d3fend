import{s as Nt,e as u,b as A,t as k,d as h,f as p,j as w,v as Ie,i as f,h as b,w as o,k as j,l as i,p as L,L as Ct,y as nt,o as mt,q as Vt,m as Be,I as Ot,Y as Bt,E as kt,n as De,x as Mt,J as bt,P as yt}from"../chunks/scheduler.BuUavueM.js";import{h as Ut,u as Ft}from"../chunks/await_block.8NTS1AiM.js";import{e as Tt}from"../chunks/each.Ckho9Dz0.js";import{S as Wt,i as Ht,t as ke,e as st,a as Te,f as Rt,c as it,b as rt,m as ct,d as ot,g as at}from"../chunks/index.B8nkrWGc.js";import{w as tt}from"../chunks/index.hAAhajWd.js";import{S as zt}from"../chunks/Search-Result.BflK3PKo.js";import{p as Gt}from"../chunks/stores.1wZ9lVii.js";import{A as Jt}from"../chunks/Alert.Ci27c02Q.js";import{G as Yt}from"../chunks/Graph-off_to_def.DtF1HkgV.js";async function $t({fetch:t}){const e=await Promise.all([t("/api/matrix-graph.json"),t("/api/offensive-technique/all.json"),t("/search/search.json"),t("/api/weakness/all.json")]),[l,s,n,r]=await Promise.all(e.map(c=>c.json()));return{matrixGraph:l,offensiveTechnique:s,digitalArtifact:n,weakness:r}}const gl=Object.freeze(Object.defineProperty({__proto__:null,load:$t},Symbol.toStringTag,{value:"Module"}));function jt(t,e,l){const s=t.slice();return s[49]=e[l],s}function Kt(t){let e,l,s=t[52]+"",n;return{c(){e=u("div"),l=k("An unexpected error occurred: "),n=k(s),this.h()},l(r){e=h(r,"DIV",{class:!0});var a=p(e);l=b(a,"An unexpected error occurred: "),n=b(a,s),a.forEach(f),this.h()},h(){o(e,"class","font-large text-center")},m(r,a){j(r,e,a),i(e,l),i(e,n)},p:De,d(r){r&&f(e)}}}function Qt(t){let e;function l(r,a){return r[11]?Zt:Xt}let s=l(t),n=s(t);return{c(){n.c(),e=bt()},l(r){n.l(r),e=bt()},m(r,a){n.m(r,a),j(r,e,a)},p(r,a){s===(s=l(r))&&n?n.p(r,a):(n.d(1),n=s(r),n&&(n.c(),n.m(e.parentNode,e)))},d(r){r&&f(e),n.d(r)}}}function Xt(t){let e,l,s;return{c(){e=u("input"),this.h()},l(n){e=h(n,"INPUT",{class:!0,placeholder:!0}),this.h()},h(){o(e,"class","search svelte-jg9y1k"),o(e,"placeholder","Search...")},m(n,r){j(n,e,r),yt(e,t[0]),l||(s=[L(e,"input",t[21]),L(e,"input",t[22])],l=!0)},p(n,r){r[0]&1&&e.value!==n[0]&&yt(e,n[0])},d(n){n&&f(e),l=!1,nt(s)}}}function Zt(t){let e,l;return{c(){e=u("div"),l=k(t[11]),this.h()},l(s){e=h(s,"DIV",{class:!0});var n=p(e);l=b(n,t[11]),n.forEach(f),this.h()},h(){o(e,"class","font-large text-center")},m(s,n){j(s,e,n),i(e,l)},p(s,n){n[0]&2048&&Be(l,s[11])},d(s){s&&f(e)}}}function xt(t){let e;return{c(){e=k("loading...")},l(l){e=b(l,"loading...")},m(l,s){j(l,e,s)},p:De,d(l){l&&f(e)}}}function Et(t){let e,l,s=t[12].defensiveTactic+"",n,r;return{c(){e=k("("),l=u("span"),n=k(s),r=k(")"),this.h()},l(a){e=b(a,"("),l=h(a,"SPAN",{class:!0});var c=p(l);n=b(c,s),c.forEach(f),r=b(a,")"),this.h()},h(){o(l,"class","text-bold")},m(a,c){j(a,e,c),j(a,l,c),i(l,n),j(a,r,c)},p(a,c){c[0]&4096&&s!==(s=a[12].defensiveTactic+"")&&Be(n,s)},d(a){a&&(f(e),f(l),f(r))}}}function Dt(t){let e,l,s=t[12].defensiveTechnique+"",n,r;return{c(){e=k("("),l=u("span"),n=k(s),r=k(")"),this.h()},l(a){e=b(a,"("),l=h(a,"SPAN",{class:!0});var c=p(l);n=b(c,s),c.forEach(f),r=b(a,")"),this.h()},h(){o(l,"class","text-bold")},m(a,c){j(a,e,c),j(a,l,c),i(l,n),j(a,r,c)},p(a,c){c[0]&4096&&s!==(s=a[12].defensiveTechnique+"")&&Be(n,s)},d(a){a&&(f(e),f(l),f(r))}}}function At(t){let e,l,s=t[12].offensiveTechnique+"",n,r;return{c(){e=k("("),l=u("span"),n=k(s),r=k(")"),this.h()},l(a){e=b(a,"("),l=h(a,"SPAN",{class:!0});var c=p(l);n=b(c,s),c.forEach(f),r=b(a,")"),this.h()},h(){o(l,"class","text-bold")},m(a,c){j(a,e,c),j(a,l,c),i(l,n),j(a,r,c)},p(a,c){c[0]&4096&&s!==(s=a[12].offensiveTechnique+"")&&Be(n,s)},d(a){a&&(f(e),f(l),f(r))}}}function wt(t){let e,l,s=t[12].digitalArtifact+"",n,r;return{c(){e=k("("),l=u("span"),n=k(s),r=k(")"),this.h()},l(a){e=b(a,"("),l=h(a,"SPAN",{class:!0});var c=p(l);n=b(c,s),c.forEach(f),r=b(a,")"),this.h()},h(){o(l,"class","text-bold")},m(a,c){j(a,e,c),j(a,l,c),i(l,n),j(a,r,c)},p(a,c){c[0]&4096&&s!==(s=a[12].digitalArtifact+"")&&Be(n,s)},d(a){a&&(f(e),f(l),f(r))}}}function Lt(t){let e,l,s=t[12].weakness+"",n,r;return{c(){e=k("("),l=u("span"),n=k(s),r=k(")"),this.h()},l(a){e=b(a,"("),l=h(a,"SPAN",{class:!0});var c=p(l);n=b(c,s),c.forEach(f),r=b(a,")"),this.h()},h(){o(l,"class","text-bold")},m(a,c){j(a,e,c),j(a,l,c),i(l,n),j(a,r,c)},p(a,c){c[0]&4096&&s!==(s=a[12].weakness+"")&&Be(n,s)},d(a){a&&(f(e),f(l),f(r))}}}function qt(t){let e,l,s;function n(a){t[37](a)}let r={result:t[49],openDefendModal:t[16]};return t[2]!==void 0&&(r.isLoading=t[2]),e=new zt({props:r}),Ot.push(()=>Rt(e,"isLoading",n)),{c(){it(e.$$.fragment)},l(a){rt(e.$$.fragment,a)},m(a,c){ct(e,a,c),s=!0},p(a,c){const d={};c[0]&1026&&(d.result=a[49]),!l&&c[0]&4&&(l=!0,d.isLoading=a[2],Bt(()=>l=!1)),e.$set(d)},i(a){s||(ke(e.$$.fragment,a),s=!0)},o(a){Te(e.$$.fragment,a),s=!1},d(a){ot(e,a)}}}function It(t){let e,l="Load more",s,n;return{c(){e=u("button"),e.textContent=l,this.h()},l(r){e=h(r,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),Ie(e)!=="svelte-1i8pjer"&&(e.textContent=l),this.h()},h(){o(e,"class","load-more-btn svelte-jg9y1k"),kt(e,"margin","0 auto"),kt(e,"display","block")},m(r,a){j(r,e,a),s||(n=L(e,"click",t[38]),s=!0)},p:De,d(r){r&&f(e),s=!1,n()}}}function el(t){let e,l,s,n="Ã—",r,a,c,d,M="D3FEND Inferred Relationships",ae,U,G,q,F,le,J,H,B,C,Y,$,ye,y=t[14].off_to_def.results.bindings.length>0&&St(t);return F=new Yt({props:{off_to_def:t[14].off_to_def}}),{c(){e=u("div"),l=u("div"),s=u("span"),s.textContent=n,r=A(),a=u("section"),c=u("div"),d=u("h2"),d.textContent=M,ae=A(),y&&y.c(),U=A(),G=u("br"),q=A(),it(F.$$.fragment),le=A(),J=u("div"),H=u("a"),B=k("json"),this.h()},l(T){e=h(T,"DIV",{class:!0,role:!0,tabindex:!0});var K=p(e);l=h(K,"DIV",{class:!0,role:!0,tabindex:!0});var se=p(l);s=h(se,"SPAN",{class:!0,role:!0,tabindex:!0,"data-svelte-h":!0}),Ie(s)!=="svelte-bibxzt"&&(s.textContent=n),r=w(se),a=h(se,"SECTION",{});var R=p(a);c=h(R,"DIV",{class:!0});var I=p(c);d=h(I,"H2",{class:!0,"data-svelte-h":!0}),Ie(d)!=="svelte-u3n8h4"&&(d.textContent=M),ae=w(I),y&&y.l(I),U=w(I),G=h(I,"BR",{}),q=w(I),rt(F.$$.fragment,I),le=w(I),J=h(I,"DIV",{class:!0});var je=p(J);H=h(je,"A",{href:!0});var be=p(H);B=b(be,"json"),be.forEach(f),je.forEach(f),I.forEach(f),R.forEach(f),se.forEach(f),K.forEach(f),this.h()},h(){o(s,"class","close-button svelte-jg9y1k"),o(s,"role","button"),o(s,"tabindex","0"),o(d,"class","text-center"),o(H,"href",C=`/api/offensive-technique/attack/${t[14].technique_id}.json`),o(J,"class","text-right"),o(c,"class","text-center card"),o(l,"class","modal-content svelte-jg9y1k"),o(l,"role","button"),o(l,"tabindex","0"),o(e,"class","defend-modal svelte-jg9y1k"),o(e,"role","button"),o(e,"tabindex","0")},m(T,K){j(T,e,K),i(e,l),i(l,s),i(l,r),i(l,a),i(a,c),i(c,d),i(c,ae),y&&y.m(c,null),i(c,U),i(c,G),i(c,q),ct(F,c,null),i(c,le),i(c,J),i(J,H),i(H,B),Y=!0,$||(ye=[L(s,"click",t[17]),L(s,"keydown",lt),L(l,"click",nl),L(l,"keydown",lt),L(e,"click",t[17]),L(e,"keydown",lt)],$=!0)},p(T,K){T[14].off_to_def.results.bindings.length>0?y?K[0]&16384&&ke(y,1):(y=St(T),y.c(),ke(y,1),y.m(c,U)):y&&(at(),Te(y,1,1,()=>{y=null}),st());const se={};K[0]&16384&&(se.off_to_def=T[14].off_to_def),F.$set(se),(!Y||K[0]&16384&&C!==(C=`/api/offensive-technique/attack/${T[14].technique_id}.json`))&&o(H,"href",C)},i(T){Y||(ke(y),ke(F.$$.fragment,T),Y=!0)},o(T){Te(y),Te(F.$$.fragment,T),Y=!1},d(T){T&&f(e),y&&y.d(),ot(F),$=!1,nt(ye)}}}function tl(t){let e,l='<div class="loading-message svelte-jg9y1k"><p>Loading...</p></div>';return{c(){e=u("div"),e.innerHTML=l,this.h()},l(s){e=h(s,"DIV",{class:!0,"data-svelte-h":!0}),Ie(e)!=="svelte-19nefe3"&&(e.innerHTML=l),this.h()},h(){o(e,"class","loading-overlay svelte-jg9y1k")},m(s,n){j(s,e,n)},p:De,i:De,o:De,d(s){s&&f(e)}}}function St(t){let e,l,s;return l=new Jt({props:{$$slots:{default:[ll]},$$scope:{ctx:t}}}),{c(){e=u("div"),it(l.$$.fragment),this.h()},l(n){e=h(n,"DIV",{class:!0});var r=p(e);rt(l.$$.fragment,r),r.forEach(f),this.h()},h(){o(e,"class","content")},m(n,r){j(n,e,r),ct(l,e,null),s=!0},i(n){s||(ke(l.$$.fragment,n),s=!0)},o(n){Te(l.$$.fragment,n),s=!1},d(n){n&&f(e),ot(l)}}}function ll(t){let e,l="Browse the D3FEND knowledge graph by clicking on the nodes below.";return{c(){e=u("small"),e.textContent=l},l(s){e=h(s,"SMALL",{"data-svelte-h":!0}),Ie(e)!=="svelte-cj5juo"&&(e.textContent=l)},m(s,n){j(s,e,n)},p:De,d(s){s&&f(e)}}}function sl(t){let e,l,s,n,r,a,c,d,M,ae="Search By",U,G,q,F,le,J,H,B,C,Y,$,ye,y,T,K="Type",se,R,I,je,be,Me,Se,S,ue,Ue,Ae,Fe,We,ne,he,He,we,Re,ze,ie,de,Ge,Le,Je,Ye,re,pe,$e,_,ce,z,oe,_e,P,v,fe,ge,N,m,V,xe,ft,ve={ctx:t,current:null,token:null,hasCatch:!0,pending:xt,then:Qt,catch:Kt,value:20,error:52};Ut(t[19],ve);let Q=t[1].length>0&&Et(t),X=t[1].length>0&&Dt(t),Z=t[1].length>0&&At(t),x=t[1].length>0&&wt(t),ee=t[1].length>0&&Lt(t),qe=Tt(t[1].slice(0,t[10])),D=[];for(let E=0;E<qe.length;E+=1)D[E]=qt(jt(t,qe,E));const Pt=E=>Te(D[E],1,1,()=>{D[E]=null});let te=t[1].length>t[10]&&It(t);const ut=[tl,el],Ee=[];function ht(E,g){return E[13]?0:E[14]?1:-1}return~(N=ht(t))&&(m=Ee[N]=ut[N](t)),{c(){e=u("body"),ve.block.c(),l=A(),s=u("div"),n=u("div"),r=u("div"),a=u("div"),c=u("div"),d=u("div"),M=u("h3"),M.textContent=ae,U=A(),G=u("label"),q=u("input"),F=A(),le=u("span"),J=k(" Title"),H=A(),B=u("label"),C=u("input"),Y=A(),$=u("span"),ye=k(" Definition"),y=A(),T=u("h3"),T.textContent=K,se=A(),R=u("label"),I=u("input"),je=A(),be=u("span"),Me=k(" Defensive Tactic "),Q&&Q.c(),Se=A(),S=u("label"),ue=u("input"),Ue=A(),Ae=u("span"),Fe=k(" Defensive Technique "),X&&X.c(),We=A(),ne=u("label"),he=u("input"),He=A(),we=u("span"),Re=k(" Offensive Technique "),Z&&Z.c(),ze=A(),ie=u("label"),de=u("input"),Ge=A(),Le=u("span"),Je=k(" Digital Artifact "),x&&x.c(),Ye=A(),re=u("label"),pe=u("input"),$e=A(),_=u("span"),ce=k(" Weakness "),ee&&ee.c(),z=A(),oe=u("div"),_e=u("div"),P=u("div"),v=u("ul");for(let E=0;E<D.length;E+=1)D[E].c();fe=A(),te&&te.c(),ge=A(),m&&m.c(),this.h()},l(E){e=h(E,"BODY",{class:!0});var g=p(e);ve.block.l(g),l=w(g),s=h(g,"DIV",{class:!0});var me=p(s);n=h(me,"DIV",{class:!0});var O=p(n);r=h(O,"DIV",{class:!0});var Ke=p(r);a=h(Ke,"DIV",{class:!0});var dt=p(a);c=h(dt,"DIV",{class:!0});var pt=p(c);d=h(pt,"DIV",{class:!0});var W=p(d);M=h(W,"H3",{class:!0,"data-svelte-h":!0}),Ie(M)!=="svelte-wehfah"&&(M.textContent=ae),U=w(W),G=h(W,"LABEL",{class:!0});var Qe=p(G);q=h(Qe,"INPUT",{type:!0,class:!0}),F=w(Qe),le=h(Qe,"SPAN",{class:!0}),p(le).forEach(f),J=b(Qe," Title"),Qe.forEach(f),H=w(W),B=h(W,"LABEL",{class:!0});var Xe=p(B);C=h(Xe,"INPUT",{type:!0,class:!0}),Y=w(Xe),$=h(Xe,"SPAN",{class:!0}),p($).forEach(f),ye=b(Xe," Definition"),Xe.forEach(f),y=w(W),T=h(W,"H3",{class:!0,"data-svelte-h":!0}),Ie(T)!=="svelte-7znsuk"&&(T.textContent=K),se=w(W),R=h(W,"LABEL",{class:!0});var Pe=p(R);I=h(Pe,"INPUT",{type:!0,class:!0}),je=w(Pe),be=h(Pe,"SPAN",{class:!0}),p(be).forEach(f),Me=b(Pe," Defensive Tactic "),Q&&Q.l(Pe),Pe.forEach(f),Se=w(W),S=h(W,"LABEL",{class:!0});var Ne=p(S);ue=h(Ne,"INPUT",{type:!0,class:!0}),Ue=w(Ne),Ae=h(Ne,"SPAN",{class:!0}),p(Ae).forEach(f),Fe=b(Ne," Defensive Technique "),X&&X.l(Ne),Ne.forEach(f),We=w(W),ne=h(W,"LABEL",{class:!0});var Ce=p(ne);he=h(Ce,"INPUT",{type:!0,class:!0}),He=w(Ce),we=h(Ce,"SPAN",{class:!0}),p(we).forEach(f),Re=b(Ce," Offensive Technique "),Z&&Z.l(Ce),Ce.forEach(f),ze=w(W),ie=h(W,"LABEL",{class:!0});var Ve=p(ie);de=h(Ve,"INPUT",{type:!0,class:!0}),Ge=w(Ve),Le=h(Ve,"SPAN",{class:!0}),p(Le).forEach(f),Je=b(Ve," Digital Artifact "),x&&x.l(Ve),Ve.forEach(f),Ye=w(W),re=h(W,"LABEL",{class:!0});var Oe=p(re);pe=h(Oe,"INPUT",{type:!0,class:!0}),$e=w(Oe),_=h(Oe,"SPAN",{class:!0}),p(_).forEach(f),ce=b(Oe," Weakness "),ee&&ee.l(Oe),Oe.forEach(f),W.forEach(f),pt.forEach(f),dt.forEach(f),Ke.forEach(f),z=w(O),oe=h(O,"DIV",{class:!0});var _t=p(oe);_e=h(_t,"DIV",{class:!0});var gt=p(_e);P=h(gt,"DIV",{class:!0});var vt=p(P);v=h(vt,"UL",{class:!0});var Ze=p(v);for(let et=0;et<D.length;et+=1)D[et].l(Ze);fe=w(Ze),te&&te.l(Ze),Ze.forEach(f),vt.forEach(f),gt.forEach(f),_t.forEach(f),O.forEach(f),me.forEach(f),ge=w(g),m&&m.l(g),g.forEach(f),this.h()},h(){o(M,"class","svelte-jg9y1k"),o(q,"type","checkbox"),o(q,"class","svelte-jg9y1k"),o(le,"class","checkmark svelte-jg9y1k"),o(G,"class","svelte-jg9y1k"),o(C,"type","checkbox"),o(C,"class","svelte-jg9y1k"),o($,"class","checkmark svelte-jg9y1k"),o(B,"class","svelte-jg9y1k"),o(T,"class","svelte-jg9y1k"),o(I,"type","checkbox"),o(I,"class","svelte-jg9y1k"),o(be,"class","checkmark svelte-jg9y1k"),o(R,"class","svelte-jg9y1k"),o(ue,"type","checkbox"),o(ue,"class","svelte-jg9y1k"),o(Ae,"class","checkmark svelte-jg9y1k"),o(S,"class","svelte-jg9y1k"),o(he,"type","checkbox"),o(he,"class","svelte-jg9y1k"),o(we,"class","checkmark svelte-jg9y1k"),o(ne,"class","svelte-jg9y1k"),o(de,"type","checkbox"),o(de,"class","svelte-jg9y1k"),o(Le,"class","checkmark svelte-jg9y1k"),o(ie,"class","svelte-jg9y1k"),o(pe,"type","checkbox"),o(pe,"class","svelte-jg9y1k"),o(_,"class","checkmark svelte-jg9y1k"),o(re,"class","svelte-jg9y1k"),o(d,"class","filters svelte-jg9y1k"),o(c,"class","content-container svelte-jg9y1k"),o(a,"class","left-column svelte-jg9y1k"),o(r,"class","column svelte-jg9y1k"),o(v,"class","svelte-jg9y1k"),o(P,"class","results svelte-jg9y1k"),o(_e,"class","right-column svelte-jg9y1k"),o(oe,"class","column svelte-jg9y1k"),o(n,"class","row svelte-jg9y1k"),o(s,"class","wrapper svelte-jg9y1k"),o(e,"class","svelte-jg9y1k")},m(E,g){j(E,e,g),ve.block.m(e,ve.anchor=null),ve.mount=()=>e,ve.anchor=l,i(e,l),i(e,s),i(s,n),i(n,r),i(r,a),i(a,c),i(c,d),i(d,M),i(d,U),i(d,G),i(G,q),q.checked=t[8],i(G,F),i(G,le),i(G,J),i(d,H),i(d,B),i(B,C),C.checked=t[9],i(B,Y),i(B,$),i(B,ye),i(d,y),i(d,T),i(d,se),i(d,R),i(R,I),I.checked=t[3],i(R,je),i(R,be),i(R,Me),Q&&Q.m(R,null),i(d,Se),i(d,S),i(S,ue),ue.checked=t[5],i(S,Ue),i(S,Ae),i(S,Fe),X&&X.m(S,null),i(d,We),i(d,ne),i(ne,he),he.checked=t[4],i(ne,He),i(ne,we),i(ne,Re),Z&&Z.m(ne,null),i(d,ze),i(d,ie),i(ie,de),de.checked=t[6],i(ie,Ge),i(ie,Le),i(ie,Je),x&&x.m(ie,null),i(d,Ye),i(d,re),i(re,pe),pe.checked=t[7],i(re,$e),i(re,_),i(re,ce),ee&&ee.m(re,null),i(n,z),i(n,oe),i(oe,_e),i(_e,P),i(P,v);for(let me=0;me<D.length;me+=1)D[me]&&D[me].m(v,null);i(v,fe),te&&te.m(v,null),i(e,ge),~N&&Ee[N].m(e,null),V=!0,xe||(ft=[L(q,"change",t[23]),L(q,"change",t[24]),L(C,"change",t[25]),L(C,"change",t[26]),L(I,"change",t[27]),L(I,"change",t[28]),L(ue,"change",t[29]),L(ue,"change",t[30]),L(he,"change",t[31]),L(he,"change",t[32]),L(de,"change",t[33]),L(de,"change",t[34]),L(pe,"change",t[35]),L(pe,"change",t[36])],xe=!0)},p(E,g){if(t=E,Ft(ve,t,g),g[0]&256&&(q.checked=t[8]),g[0]&512&&(C.checked=t[9]),g[0]&8&&(I.checked=t[3]),t[1].length>0?Q?Q.p(t,g):(Q=Et(t),Q.c(),Q.m(R,null)):Q&&(Q.d(1),Q=null),g[0]&32&&(ue.checked=t[5]),t[1].length>0?X?X.p(t,g):(X=Dt(t),X.c(),X.m(S,null)):X&&(X.d(1),X=null),g[0]&16&&(he.checked=t[4]),t[1].length>0?Z?Z.p(t,g):(Z=At(t),Z.c(),Z.m(ne,null)):Z&&(Z.d(1),Z=null),g[0]&64&&(de.checked=t[6]),t[1].length>0?x?x.p(t,g):(x=wt(t),x.c(),x.m(ie,null)):x&&(x.d(1),x=null),g[0]&128&&(pe.checked=t[7]),t[1].length>0?ee?ee.p(t,g):(ee=Lt(t),ee.c(),ee.m(re,null)):ee&&(ee.d(1),ee=null),g[0]&66566){qe=Tt(t[1].slice(0,t[10]));let O;for(O=0;O<qe.length;O+=1){const Ke=jt(t,qe,O);D[O]?(D[O].p(Ke,g),ke(D[O],1)):(D[O]=qt(Ke),D[O].c(),ke(D[O],1),D[O].m(v,fe))}for(at(),O=qe.length;O<D.length;O+=1)Pt(O);st()}t[1].length>t[10]?te?te.p(t,g):(te=It(t),te.c(),te.m(v,null)):te&&(te.d(1),te=null);let me=N;N=ht(t),N===me?~N&&Ee[N].p(t,g):(m&&(at(),Te(Ee[me],1,1,()=>{Ee[me]=null}),st()),~N?(m=Ee[N],m?m.p(t,g):(m=Ee[N]=ut[N](t),m.c()),ke(m,1),m.m(e,null)):m=null)},i(E){if(!V){for(let g=0;g<qe.length;g+=1)ke(D[g]);ke(m),V=!0}},o(E){D=D.filter(Boolean);for(let g=0;g<D.length;g+=1)Te(D[g]);Te(m),V=!1},d(E){E&&f(e),ve.block.d(),ve.token=null,ve=null,Q&&Q.d(),X&&X.d(),Z&&Z.d(),x&&x.d(),ee&&ee.d(),Ct(D,E),te&&te.d(),~N&&Ee[N].d(),xe=!1,nt(ft)}}}function lt(){console.log("keydown")}async function al(t){try{const e=await fetch(`/api/offensive-technique/attack/${t}.json`);if(!e.ok)throw new Error(`Error fetching data: ${e.status}`);const{description:l,off_to_def:s,subtechniques:n}=await e.json();return{description:l,off_to_def:s,technique_id:t,subtechniques:n}}catch(e){return console.error("Error fetching defensive data:",e),{error:e.message}}}const nl=t=>t.stopPropagation();function il(t,e,l){let s,n,r=De,a=()=>(r(),r=Mt(q,_=>l(13,n=_)),q),c;mt(t,Gt,_=>l(43,s=_)),t.$$.on_destroy.push(()=>r());let{data:d}=e,M=[],ae="",U=[],G=tt(null),q=tt(!1);a();let F=tt(null);mt(t,F,_=>l(14,c=_));let le=!1,J=!1,H=!1,B=!1,C=!1,Y=!1,$=!1,ye=20,y,T=null,K,se="",R={defensiveTactic:0,defensiveTechnique:0,offensiveTechnique:0,digitalArtifact:0};K=s.url.searchParams.get("q"),console.log("Found params: "+K);async function I(_){q.set(!0),G.set(_.item);try{const ce=await al(_.item["@id"].split(":")[1]);F.set(ce)}catch(ce){console.error("Error during data fetch:",ce),F.set(null)}finally{q.set(!1)}}function je(){q.set(!1),G.set(null),F.set(null)}async function be(){const _="d3fend_search_cache",ce=localStorage.getItem(_);if(ce)try{return M=JSON.parse(ce),M}catch(z){console.error("Failed to parse cached data",z)}try{{let z=d.matrixGraph["@graph"].map(v=>({...v,itemType:v["@type"]&&v["@type"].includes("d3f:DefensiveTactic")?"Defensive Tactic":"Defensive Technique"})),oe=d.offensiveTechnique["@graph"].map(v=>({...v,itemType:"Offensive Technique"})),_e=d.digitalArtifact["@graph"].map(v=>({...v,itemType:"Digital Artifact"})),P=d.weakness["@graph"].map(v=>({...v,itemType:"Weakness"}));return M=[...z,...oe,..._e,...P],localStorage.setItem(_,JSON.stringify(M)),M}}catch(z){l(11,T="Failed to load data, check console log for more details."),console.error("Failed to load data for search",z)}}function Me(_){if(!le&&!J&&!H&&!B&&!C)return!0;switch(_){case"Defensive Tactic":return le;case"Offensive Technique":return J;case"Defensive Technique":return H;case"Digital Artifact":return B;case"Weakness":return C;default:return!1}}function Se(_,ce){const z=ce.toLowerCase();if(z==="")return[];const oe=P=>{const v=P.toLowerCase().indexOf(z);if(v===-1)return P;const fe=P.substring(0,v),ge=P.substring(v,v+z.length),N=P.substring(v+z.length);return`${fe}<span class="highlight">${ge}</span>${N}`};let _e=_.reduce((P,v)=>{let fe=[],ge={...v},N=0;try{if(Y||!Y&&!$){let V=v["rdfs:label"];Array.isArray(V)&&V.length>0&&(V=V[0]),V&&V.toLowerCase().includes(z)&&(fe.push("label"),ge["rdfs:label"]=oe(V),N+=10)}if($||!Y&&!$){let V=v["d3f:definition"];Array.isArray(V)&&V.length>0&&(V=V[0]),V&&V.toLowerCase().includes(z)&&(fe.push("definition"),ge["d3f:definition"]=oe(V),N+=5)}let m=v["rdfs:label"];Array.isArray(m)&&m.length>0&&(m=m[0]),m&&m.toLowerCase().includes(z)&&(fe.push("off"),ge["rdfs:label"]=oe(m))}catch(m){l(11,T="Failed to load data, check console log for more details."),console.error("Failed to load data for search",m)}if(fe.length>0){const m=ge.itemType;Me(m)&&P.push({item:ge,matchedOn:fe,score:N})}return P},[]);return s.url.searchParams.set("q",ce),history.replaceState(null,"",s.url),_e.sort((P,v)=>v.score-P.score),_e.map(P=>({item:P.item,matchedOn:P.matchedOn}))}function S(_=!1){_?l(1,U=Se(M,ae)):(clearTimeout(y),y=setTimeout(()=>{l(1,U=Se(M,ae)),ue()},500))}function ue(){l(12,R={defensiveTactic:U.filter(_=>_.item.itemType==="Defensive Tactic").length,defensiveTechnique:U.filter(_=>_.item.itemType==="Defensive Technique").length,offensiveTechnique:U.filter(_=>_.item.itemType==="Offensive Technique").length,digitalArtifact:U.filter(_=>_.item.itemType==="Digital Artifact").length,weakness:U.filter(_=>_.item.itemType==="Weakness").length})}let Ue=be();Vt(async()=>{K?(se=K,l(0,ae=se),S(!1)):se="",s.url.searchParams.set("q",ae),history.replaceState(null,"",s.url)});function Ae(){ae=this.value,l(0,ae)}const Fe=()=>{S(!1)};function We(){Y=this.checked,l(8,Y)}const ne=()=>{S(!0)};function he(){$=this.checked,l(9,$)}const He=()=>{S(!0)};function we(){le=this.checked,l(3,le)}const Re=()=>{S(!0)};function ze(){H=this.checked,l(5,H)}const ie=()=>{S(!0)};function de(){J=this.checked,l(4,J)}const Ge=()=>{S(!0)};function Le(){B=this.checked,l(6,B)}const Je=()=>{S(!0)};function Ye(){C=this.checked,l(7,C)}const re=()=>{S(!0)};function pe(_){q=_,a(l(2,q))}const $e=()=>{l(10,ye=U.length)};return t.$$set=_=>{"data"in _&&l(20,d=_.data)},[ae,U,q,le,J,H,B,C,Y,$,ye,T,R,n,c,F,I,je,S,Ue,d,Ae,Fe,We,ne,he,He,we,Re,ze,ie,de,Ge,Le,Je,Ye,re,pe,$e]}class vl extends Wt{constructor(e){super(),Ht(this,e,il,sl,Nt,{data:20},null,[-1,-1])}}export{vl as component,gl as universal};
