import{s as ne,I as we,e as g,b as y,J as H,d as x,j as ee,f as Te,i as t,w as Le,k as _,Y as Ae,v as De,n as _e,t as p,h as o,L as Re,m as q}from"./scheduler.BuUavueM.js";import{S as Be,i as Ce,f as Ge,c as de,b as ke,m as he,g as $e,a as K,e as Ne,t as Q,d as qe}from"./index.B8nkrWGc.js";import{e as ie}from"./each.Ckho9Dz0.js";import{G as Me}from"./_Graph.BQtyR-cL.js";import{a as Se,T as Ee,b as R,d as ae}from"./lib.BDR6A2xH.js";import{T as He,t as ue}from"./ToggleBar.BqwPd21l.js";function ce(i,v,s){const l=i.slice();return l[6]=v[s],l}function Ie(i){let v,s=`There are no digital artifacts defined on this offensive technique (yet).
    Please consider <a href="/contribute">contributing</a> an addition to D3FEND.`;return{c(){v=g("small"),v.innerHTML=s},l(l){v=x(l,"SMALL",{"data-svelte-h":!0}),De(v)!=="svelte-1ymw1cs"&&(v.innerHTML=s)},m(l,e){_(l,v,e)},p:_e,i:_e,o:_e,d(l){l&&t(v)}}}function Oe(i){let v=i[1],s,l,e=me(i);return{c(){e.c(),s=H()},l(f){e.l(f),s=H()},m(f,b){e.m(f,b),_(f,s,b),l=!0},p(f,b){b&2&&ne(v,v=f[1])?($e(),K(e,1,1,_e),Ne(),e=me(f),e.c(),Q(e,1),e.m(s.parentNode,s)):e.p(f,b)},i(f){l||(Q(e),l=!0)},o(f){K(e),l=!1},d(f){f&&t(s),e.d(f)}}}function ve(i){let v=i[2].edge_is_unique(i[6].def_tech_label.value,i[6].def_artifact_rel_label.value,i[6].off_artifact_label.value),s,l=v&&se(i);return{c(){l&&l.c(),s=H()},l(e){l&&l.l(e),s=H()},m(e,f){l&&l.m(e,f),_(e,s,f)},p(e,f){f&1&&(v=e[2].edge_is_unique(e[6].def_tech_label.value,e[6].def_artifact_rel_label.value,e[6].off_artifact_label.value)),v?l?l.p(e,f):(l=se(e),l.c(),l.m(s.parentNode,s)):l&&(l.d(1),l=null)},d(e){e&&t(s),l&&l.d(e)}}}function se(i){let v=!i[1].includes(i[6].def_tactic_label.value),s,l=v&&be(i);return{c(){l&&l.c(),s=H()},l(e){l&&l.l(e),s=H()},m(e,f){l&&l.m(e,f),_(e,s,f)},p(e,f){f&3&&(v=!e[1].includes(e[6].def_tactic_label.value)),v?l?l.p(e,f):(l=be(e),l.c(),l.m(s.parentNode,s)):l&&(l.d(1),l=null)},d(e){e&&t(s),l&&l.d(e)}}}function be(i){let v=R(i[6].def_tech.value)+"",s,l,e=i[6].def_tech_label.value+"",f,b,r="-->",w,h,T=i[6].def_artifact_rel_label.value.replace(/ /g,"")+"",k,N,L=R(i[6].off_artifact.value)+"",D,M,C=i[6].off_artifact_label.value+"",G,A,m=i[2].edge_is_unique(i[6].def_tech.value,i[6].def_tactic_label.value,i[6].off_tech_id.value),c,$=i[6].def_tech_label.value.replace(/ |\./g,"")+"",S,E,F=i[6].off_artifact_label.value.replace(/ /g,"")+"",I,J,P=R(i[6].def_tech.value)+"",O,V,Y=R(i[6].def_tech.value)+"",j,z,B=m&&pe(i);return{c(){s=p(v),l=p('["'),f=p(e),b=p('"] '),w=p(r),h=p(`
          | `),k=p(T),N=p(" | "),D=p(L),M=p('["'),G=p(C),A=p(`"];

          `),B&&B.c(),c=p(`
          class `),S=p($),E=p(` DefensiveTechniqueNode;
          class `),I=p(F),J=p(` ArtifactNode;
          click `),O=p(P),V=p(' href "/technique/d3f:'),j=p(Y),z=p('";')},l(u){s=o(u,v),l=o(u,'["'),f=o(u,e),b=o(u,'"] '),w=o(u,r),h=o(u,`
          | `),k=o(u,T),N=o(u," | "),D=o(u,L),M=o(u,'["'),G=o(u,C),A=o(u,`"];

          `),B&&B.l(u),c=o(u,`
          class `),S=o(u,$),E=o(u,` DefensiveTechniqueNode;
          class `),I=o(u,F),J=o(u,` ArtifactNode;
          click `),O=o(u,P),V=o(u,' href "/technique/d3f:'),j=o(u,Y),z=o(u,'";')},m(u,d){_(u,s,d),_(u,l,d),_(u,f,d),_(u,b,d),_(u,w,d),_(u,h,d),_(u,k,d),_(u,N,d),_(u,D,d),_(u,M,d),_(u,G,d),_(u,A,d),B&&B.m(u,d),_(u,c,d),_(u,S,d),_(u,E,d),_(u,I,d),_(u,J,d),_(u,O,d),_(u,V,d),_(u,j,d),_(u,z,d)},p(u,d){d&1&&v!==(v=R(u[6].def_tech.value)+"")&&q(s,v),d&1&&e!==(e=u[6].def_tech_label.value+"")&&q(f,e),d&1&&T!==(T=u[6].def_artifact_rel_label.value.replace(/ /g,"")+"")&&q(k,T),d&1&&L!==(L=R(u[6].off_artifact.value)+"")&&q(D,L),d&1&&C!==(C=u[6].off_artifact_label.value+"")&&q(G,C),d&1&&(m=u[2].edge_is_unique(u[6].def_tech.value,u[6].def_tactic_label.value,u[6].off_tech_id.value)),m?B?B.p(u,d):(B=pe(u),B.c(),B.m(c.parentNode,c)):B&&(B.d(1),B=null),d&1&&$!==($=u[6].def_tech_label.value.replace(/ |\./g,"")+"")&&q(S,$),d&1&&F!==(F=u[6].off_artifact_label.value.replace(/ /g,"")+"")&&q(I,F),d&1&&P!==(P=R(u[6].def_tech.value)+"")&&q(O,P),d&1&&Y!==(Y=R(u[6].def_tech.value)+"")&&q(j,Y)},d(u){u&&(t(s),t(l),t(f),t(b),t(w),t(h),t(k),t(N),t(D),t(M),t(G),t(A),t(c),t(S),t(E),t(I),t(J),t(O),t(V),t(j),t(z)),B&&B.d(u)}}}function pe(i){let v=R(i[6].def_tech.value)+"",s,l,e=i[6].def_tech_label.value+"",f,b,r="-.->",w,h,T="may-"+i[6].def_tactic_label.value.toLowerCase(),k,N,L=i[6].off_tech_id.value.replace(/ |\./g,"")+"",D,M,C=i[6].off_tech_label.value+"",G,A;return{c(){s=p(v),l=p('["'),f=p(e),b=p('"] '),w=p(r),h=p(`
            | `),k=p(T),N=p(" | "),D=p(L),M=p('["'),G=p(C),A=p('"] ;')},l(m){s=o(m,v),l=o(m,'["'),f=o(m,e),b=o(m,'"] '),w=o(m,r),h=o(m,`
            | `),k=o(m,T),N=o(m," | "),D=o(m,L),M=o(m,'["'),G=o(m,C),A=o(m,'"] ;')},m(m,c){_(m,s,c),_(m,l,c),_(m,f,c),_(m,b,c),_(m,w,c),_(m,h,c),_(m,k,c),_(m,N,c),_(m,D,c),_(m,M,c),_(m,G,c),_(m,A,c)},p(m,c){c&1&&v!==(v=R(m[6].def_tech.value)+"")&&q(s,v),c&1&&e!==(e=m[6].def_tech_label.value+"")&&q(f,e),c&1&&T!==(T="may-"+m[6].def_tactic_label.value.toLowerCase())&&q(k,T),c&1&&L!==(L=m[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(D,L),c&1&&C!==(C=m[6].off_tech_label.value+"")&&q(G,C)},d(m){m&&(t(s),t(l),t(f),t(b),t(w),t(h),t(k),t(N),t(D),t(M),t(G),t(A))}}}function oe(i){let v=i[6].off_tech_id.value.replace(/ |\./g,"")+"",s,l,e=i[6].off_tech_label.value+"",f,b,r="-->",w,h,T=i[6].off_artifact_rel_label.value.replace(/ /g,"")+"",k,N,L=R(i[6].off_artifact.value)+"",D,M,C=i[6].off_artifact_label.value+"",G,A,m=i[6].off_tech_id.value.replace(/ |\./g,"")+"",c,$,S=R(i[6].off_artifact.value)+"",E,F,I=R(i[6].off_artifact.value)+"",J,P,O=R(i[6].off_artifact.value)+"",V,Y,j=i[6].off_tech_id.value.replace(/ |\./g,"")+"",z,B,u=ae(i[6].off_tech_id.value)+"",d,le,U=R(i[6].off_artifact.value)+"",W,fe,X=R(i[6].off_artifact.value)+"",Z,te;return{c(){s=p(v),l=p('["'),f=p(e),b=p('"] '),w=p(r),h=p(" |"),k=p(T),N=p("| "),D=p(L),M=p('["'),G=p(C),A=p('"]; class '),c=p(m),$=p(` OffensiveTechniqueNode;
        class `),E=p(S),F=p(" ArtifactNode; click "),J=p(I),P=p(' href "/dao/artifact/d3f:'),V=p(O),Y=p(`";
        click `),z=p(j),B=p(' href "'),d=p(u),le=p('"; click '),W=p(U),fe=p(' href "/dao/artifact/d3f:'),Z=p(X),te=p('";')},l(a){s=o(a,v),l=o(a,'["'),f=o(a,e),b=o(a,'"] '),w=o(a,r),h=o(a," |"),k=o(a,T),N=o(a,"| "),D=o(a,L),M=o(a,'["'),G=o(a,C),A=o(a,'"]; class '),c=o(a,m),$=o(a,` OffensiveTechniqueNode;
        class `),E=o(a,S),F=o(a," ArtifactNode; click "),J=o(a,I),P=o(a,' href "/dao/artifact/d3f:'),V=o(a,O),Y=o(a,`";
        click `),z=o(a,j),B=o(a,' href "'),d=o(a,u),le=o(a,'"; click '),W=o(a,U),fe=o(a,' href "/dao/artifact/d3f:'),Z=o(a,X),te=o(a,'";')},m(a,n){_(a,s,n),_(a,l,n),_(a,f,n),_(a,b,n),_(a,w,n),_(a,h,n),_(a,k,n),_(a,N,n),_(a,D,n),_(a,M,n),_(a,G,n),_(a,A,n),_(a,c,n),_(a,$,n),_(a,E,n),_(a,F,n),_(a,J,n),_(a,P,n),_(a,V,n),_(a,Y,n),_(a,z,n),_(a,B,n),_(a,d,n),_(a,le,n),_(a,W,n),_(a,fe,n),_(a,Z,n),_(a,te,n)},p(a,n){n&1&&v!==(v=a[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(s,v),n&1&&e!==(e=a[6].off_tech_label.value+"")&&q(f,e),n&1&&T!==(T=a[6].off_artifact_rel_label.value.replace(/ /g,"")+"")&&q(k,T),n&1&&L!==(L=R(a[6].off_artifact.value)+"")&&q(D,L),n&1&&C!==(C=a[6].off_artifact_label.value+"")&&q(G,C),n&1&&m!==(m=a[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(c,m),n&1&&S!==(S=R(a[6].off_artifact.value)+"")&&q(E,S),n&1&&I!==(I=R(a[6].off_artifact.value)+"")&&q(J,I),n&1&&O!==(O=R(a[6].off_artifact.value)+"")&&q(V,O),n&1&&j!==(j=a[6].off_tech_id.value.replace(/ |\./g,"")+"")&&q(z,j),n&1&&u!==(u=ae(a[6].off_tech_id.value)+"")&&q(d,u),n&1&&U!==(U=R(a[6].off_artifact.value)+"")&&q(W,U),n&1&&X!==(X=R(a[6].off_artifact.value)+"")&&q(Z,X)},d(a){a&&(t(s),t(l),t(f),t(b),t(w),t(h),t(k),t(N),t(D),t(M),t(G),t(A),t(c),t($),t(E),t(F),t(J),t(P),t(V),t(Y),t(z),t(B),t(d),t(le),t(W),t(fe),t(Z),t(te))}}}function re(i){let v,s=i[2].edge_is_unique(i[6].off_tech_label.value,i[6].off_artifact_rel_label.value,i[6].off_artifact_label.value),l,e="def_tech"in i[6]&&ve(i),f=s&&oe(i);return{c(){e&&e.c(),v=y(),f&&f.c(),l=H()},l(b){e&&e.l(b),v=ee(b),f&&f.l(b),l=H()},m(b,r){e&&e.m(b,r),_(b,v,r),f&&f.m(b,r),_(b,l,r)},p(b,r){"def_tech"in b[6]?e?e.p(b,r):(e=ve(b),e.c(),e.m(v.parentNode,v)):e&&(e.d(1),e=null),r&1&&(s=b[2].edge_is_unique(b[6].off_tech_label.value,b[6].off_artifact_rel_label.value,b[6].off_artifact_label.value)),s?f?f.p(b,r):(f=oe(b),f.c(),f.m(l.parentNode,l)):f&&(f.d(1),f=null)},d(b){b&&(t(v),t(l)),e&&e.d(b),f&&f.d(b)}}}function je(i){let v,s,l=ie(i[0].results.bindings),e=[];for(let f=0;f<l.length;f+=1)e[f]=re(ce(i,l,f));return{c(){v=p(`graph LR;

    `);for(let f=0;f<e.length;f+=1)e[f].c();s=H()},l(f){v=o(f,`graph LR;

    `);for(let b=0;b<e.length;b+=1)e[b].l(f);s=H()},m(f,b){_(f,v,b);for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(f,b);_(f,s,b)},p(f,b){if(b&7){l=ie(f[0].results.bindings);let r;for(r=0;r<l.length;r+=1){const w=ce(f,l,r);e[r]?e[r].p(w,b):(e[r]=re(w),e[r].c(),e[r].m(s.parentNode,s))}for(;r<e.length;r+=1)e[r].d(1);e.length=l.length}},d(f){f&&(t(v),t(s)),Re(e,f)}}}function me(i){let v,s;return v=new Me({props:{$$slots:{default:[je]},$$scope:{ctx:i}}}),{c(){de(v.$$.fragment)},l(l){ke(v.$$.fragment,l)},m(l,e){he(v,l,e),s=!0},p(l,e){const f={};e&515&&(f.$$scope={dirty:e,ctx:l}),v.$set(f)},i(l){s||(Q(v.$$.fragment,l),s=!0)},o(l){K(v.$$.fragment,l),s=!1},d(l){qe(v,l)}}}function Fe(i){let v,s,l,e,f,b,r,w,h,T,k,N,L,D;function M(c){i[4](c)}let C={toggles:i[3]};i[1]!==void 0&&(C.selected=i[1]),e=new He({props:C}),we.push(()=>Ge(e,"selected",M));const G=[Oe,Ie],A=[];function m(c,$){return c[0].results.bindings.length>0?0:1}return k=m(i),N=A[k]=G[k](i),{c(){v=g("br"),s=y(),l=g("div"),de(e.$$.fragment),b=y(),r=g("br"),w=y(),h=g("br"),T=y(),N.c(),L=H(),this.h()},l(c){v=x(c,"BR",{}),s=ee(c),l=x(c,"DIV",{class:!0});var $=Te(l);ke(e.$$.fragment,$),$.forEach(t),b=ee(c),r=x(c,"BR",{}),w=ee(c),h=x(c,"BR",{}),T=ee(c),N.l(c),L=H(),this.h()},h(){Le(l,"class","center shrink")},m(c,$){_(c,v,$),_(c,s,$),_(c,l,$),he(e,l,null),_(c,b,$),_(c,r,$),_(c,w,$),_(c,h,$),_(c,T,$),A[k].m(c,$),_(c,L,$),D=!0},p(c,[$]){const S={};!f&&$&2&&(f=!0,S.selected=c[1],Ae(()=>f=!1)),e.$set(S);let E=k;k=m(c),k===E?A[k].p(c,$):($e(),K(A[E],1,1,()=>{A[E]=null}),Ne(),N=A[k],N?N.p(c,$):(N=A[k]=G[k](c),N.c()),Q(N,1),N.m(L.parentNode,L))},i(c){D||(Q(e.$$.fragment,c),Q(N),D=!0)},o(c){K(e.$$.fragment,c),K(N),D=!1},d(c){c&&(t(v),t(s),t(l),t(b),t(r),t(w),t(h),t(T),t(L)),qe(e),A[k].d(c)}}}function Je(i,v,s){let{off_to_def:l}=v,e=new Ee,f=new Set;l.results.bindings.forEach(h=>{"def_tactic_label"in h&&f.add(h.def_tactic_label.value)});let b=Array.from(f).sort(function(h,T){return ue[h]-ue[T]}),r=["Model"];Se(b,r)&&(r=[]);function w(h){r=h,s(1,r)}return i.$$set=h=>{"off_to_def"in h&&s(0,l=h.off_to_def)},i.$$.update=()=>{i.$$.dirty&2&&e.reset(r)},[l,r,e,b,w]}class Ue extends Be{constructor(v){super(),Ce(this,v,Je,Fe,ne,{off_to_def:0})}}export{Ue as G};
